{"version":3,"sources":["../../../src/suites/unittests/logger.spec.ts"],"names":["description","TestGroup","Logger","UnitTest","g","test","t","mylog","testrec","testres","record","suite","path","res1","params2","res2","expect","spec","cases","length","params","logs","undefined","status","timems","rec","res","start","finish","log","warn","fail","debug","logsCount"],"mappings":"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","sourcesContent":["export const description = `\nUnit tests for namespaced logging system.\n\nAlso serves as a larger test of async test functions, and of the logging system.\n`;\n\nimport { TestGroup } from '../../framework/index.js';\nimport { Logger } from '../../framework/logger.js';\n\nimport { UnitTest } from './unit_test.js';\n\nexport const g = new TestGroup(UnitTest);\n\ng.test('construct', t => {\n  const mylog = new Logger();\n  const [testrec, testres] = mylog.record({ suite: 'a', path: 'foo/bar' });\n  const [, res1] = testrec.record('baz', null);\n  const params2 = {};\n  const [, res2] = testrec.record('qux', params2);\n\n  t.expect(testres.spec === 'a:foo/bar:');\n  t.expect(testres.cases.length === 2);\n  t.expect(testres.cases[0] === res1);\n  t.expect(testres.cases[1] === res2);\n  t.expect(res1.test === 'baz');\n  t.expect(res1.params === null);\n  t.expect(res1.logs === undefined);\n  t.expect(res1.status === 'running');\n  t.expect(res1.timems < 0);\n  t.expect(res2.test === 'qux');\n  t.expect(res2.params === params2);\n  t.expect(res2.logs === undefined);\n  t.expect(res2.status === 'running');\n  t.expect(res2.timems < 0);\n});\n\ng.test('empty', t => {\n  const mylog = new Logger();\n  const [testrec] = mylog.record({ suite: '', path: '' });\n  const [rec, res] = testrec.record('baz', null);\n\n  rec.start();\n  t.expect(res.status === 'running');\n  rec.finish();\n  t.expect(res.status === 'pass');\n  t.expect(res.timems >= 0);\n});\n\ng.test('pass', t => {\n  const mylog = new Logger();\n  const [testrec] = mylog.record({ suite: '', path: '' });\n  const [rec, res] = testrec.record('baz', null);\n\n  rec.start();\n  rec.log('hello');\n  t.expect(res.status === 'running');\n  rec.finish();\n  t.expect(res.status === 'pass');\n  t.expect(res.timems >= 0);\n});\n\ng.test('warn', t => {\n  const mylog = new Logger();\n  const [testrec] = mylog.record({ suite: '', path: '' });\n  const [rec, res] = testrec.record('baz', null);\n\n  rec.start();\n  rec.warn();\n  t.expect(res.status === 'running');\n  rec.finish();\n  t.expect(res.status === 'warn');\n  t.expect(res.timems >= 0);\n});\n\ng.test('fail', t => {\n  const mylog = new Logger();\n  const [testrec] = mylog.record({ suite: '', path: '' });\n  const [rec, res] = testrec.record('baz', null);\n\n  rec.start();\n  rec.fail('bye');\n  t.expect(res.status === 'running');\n  rec.finish();\n  t.expect(res.status === 'fail');\n  t.expect(res.timems >= 0);\n});\n\ng.test('debug', t => {\n  const { debug, logsCount } = t.params;\n\n  const mylog = new Logger();\n  const [testrec] = mylog.record({ suite: '', path: '' });\n  const [rec, res] = testrec.record('baz', null);\n\n  rec.start(debug);\n  rec.debug('hello');\n  rec.finish();\n  t.expect(res.status === 'pass');\n  t.expect(res.timems >= 0);\n  t.expect(res.logs!.length === logsCount);\n}).params([\n  { debug: true, logsCount: 1 }, // ()\n  { debug: false, logsCount: 0 },\n]);\n"],"file":"logger.spec.js"}